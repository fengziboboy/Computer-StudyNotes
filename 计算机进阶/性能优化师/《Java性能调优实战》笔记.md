
# 概述

## 1 | 如何制定性能标准？


### 为什么要做性能调优？

- 有些性能问题是时间累积慢慢产生的，到了一定时间自然就爆炸了；- 而更多的性能问题是由访问量的波动导致的，例如，活动或者公司产品用户量上升；

>现在假设你的系统要做一次活动，产品经理或者老板告诉你预计有几十万的用户访问量，询问系统能否承受得住这次活动的压力。

所有的系统在开发完之后，多多少少都会有性能问题，

我们首先要做的就是想办法把问题暴露出来，例如进行压力测试、模拟可能的操作场景等等，再通过性能调优去解决这些问题。


**好的系统性能调优不仅仅可以提高系统的性能，还能为公司节省资源。**  ——比如有大神把服务器的数量缩减到了原来的一半，系统的性能指标，反而还提升了。


### 什么时候开始介入调优？

- 在项目开发的初期，我们没有必要过于在意性能优化，这样反而会让我们疲于性能优化，不仅不会给系统性能带来提升，还会影响到开发进度。

- 只需要在代码层面保证有效的编码：
  - 减少磁盘 I/O 操作、降低竞争锁的使用以及使用高效的算法。
  - 遇到比较复杂的业务，我们可以充分利用设计模式来优化业务代码。例如，设计商品价格的时候，往往会有很多折扣活动、红包活动，我们可以用装饰模式去设计这个业务。


在**系统编码完成之后**，我们就可以对系统进行性能测试了。

- 产品提供线上预期数据，开发进行**压测，通过性能分析、统计工具来统计各项性能指标**，看是否在预期范围之内。

在项目成功上线后，我们还需要根据线上的实际情况，**依照日志监控以及性能统计日志**，来观测系统性能问题。


### 有哪些参考因素可以体现系统的性能？

#### 业务性能指标

- 响应时间
- 吞吐量




#### 基础指标
**CPU**：：有的应用需要大量计算，他们会长时间、不间断地占用 CPU 资源，导致其他资源无法争夺到 CPU 而响应缓慢，从而带来系统性能问题。
- 代码递归导致的无限循环
- 正则表达式引起的回溯
- JVM 频繁的 FULL GC
- 以及多线程编程造成的大量上下文切换等



**内存**：Java 程序一般通过 JVM 对内存进行分配管理，主要是用 JVM 中的堆内存来存储Java 创建的对象。
- 当内存空间被占满，对象无法回收时，就会导致内存溢出、内存泄露等问题。


**磁盘I/O**: 磁盘相比内存来说，存储空间要大很多，但磁盘 I/O 读写的速度要比内存慢。


**网络**：


#### 数据库



#### 其他

**异常：**Java 应用中，抛出异常需要**构建异常栈，对异常进行捕获和处理**，**这个过程非常消耗系统性能**。
如果在高并发的情况下引发异常，持续地进行异常处理，那么系统的性能就会明显地受到影响。


**锁竞争：**


**计算机资源分配使用率**


**负载承受能力**
