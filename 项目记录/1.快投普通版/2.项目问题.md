# 一、 快投普通版及对应干预平台新增功能
## 7.30 探讨需求，拉代码，调试跑通
### cpc-assist启动一些坑
1. 不需要resin，直接运行SpringBoot的启动类。不过在这之前需要对前端进行一些操作：
   - 准备工作：
      1. 下载和安装[node.js](https://nodejs.org/zh-cn/ )；[下载版本6.9.1](https://nodejs.org/download/release/v6.9.1/)，或者更高版本。
      2. npm set registry=http://registry.npm.sogou 
      3. npm i -g cross-env 
      4. npm i -g @bizfe/biz-dp
   - 对前端一些操作，在 `\cpc-assist-web\src\main\webapp`目录下，打开命令行，输入下面的命令：
        ```shell
        > npm install 
        > npm run build 
        ```
   - 启动CpcAssistWebApplication。
  
2. 注释掉janus的一段代码；
3. 实例化一个Janus的对象，然后对用户名，id，邮箱进行赋值（字段随意）。
4. 然后还有个Idea对于静态文件定位问题，可以参考下面博客解决：https://www.cnblogs.com/helloworld6379/p/10668119.html 
5. 最后**数据库无法访问，经过尝试是由于开了VPN！**

### 需求的一些纠正
1. 快投用户就属于小流量用户，在这基础上还要对快投用户进行区分：有商品集合的大客户和没有商品集合的普通客户，功能针对他们区分开。


## 7.31 看excel处理代码

### 看商品抓取部分的excel处理代码遇到的问题
1. schema规则是什么意思？
   ```java
   /**
	 * 获取列数对应的schema规则
	 * @param schemaDtos
	 * @return
	 */
	private Map<Integer, FeedSchemaContentDto> getColumnToFeedSchema(List<FeedSchemaContentDto> schemaDtos) {
		Map<Integer, FeedSchemaContentDto> dtoMap = new HashMap<>();
		for (FeedSchemaContentDto dto : schemaDtos) {
			dtoMap.put(dto.getColumn(), dto);
		}
		return dtoMap;
	}
   ```

2. 排序什么做什么？
   ```java
   // 对模板规则数据进行排序处理
		sortFeedSchemaDtos(schemaDtos);
		Map<Integer, FeedSchemaContentDto> dtoMap = getColumnToFeedSchema(schemaDtos);
		// 判断标题和规则中是否一一对应
		for (int i = 0; i < titleNames.size(); i++) {
			String titleName = titleNames.get(i);   //未排序吧？
			String titleHeader = titleHeaders.get(i);
			FeedSchemaContentDto dto = dtoMap.get(i);  //顺序还对应的么？
			if (StringUtils.isBlank(titleName) || StringUtils.isBlank(titleHeader) ||
					!titleName.equals(dto.getName()) || !titleHeader.equals(dto.getHeader())) {
				logger.warn("analysis excel schema data titleName or titleHeader is invalid");
				processorDto.setResult(DataProcessorConstants.FILE_HEADER_MISMATCH);
				return processorDto;
			}
		}
   ```
3. 无法导入`import org.apache.commons.collections.CollectionUtils;`

## 8.1 看代码，写上传excel，读取、处理校验，然后写sql，批量创建集团账号
 在笔记本上，有空腾上来

## 8.2 继续看代码，处理通过excel批量创建集团账号

### 编程遇到的BUG
1. 创建临时文件时，文件夹相对路径不对，报错。 	
   >C:\Users\zhaojinbo\AppData\Local\Temp\tomcat.3769104979674674954.8080\work\Tomcat\localhost\ROOT\opt\multi-temp\392118a2-b7e9-44bd-8d91-12619e2c0c16.xlsx (系统找不到指定的路径。)

## 8.12 准备联调
集团账户列表搜索：名称搜索，如果结果不存在就会报错：系统繁忙。
