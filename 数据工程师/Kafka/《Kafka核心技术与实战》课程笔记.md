

# 学习Kafka的正确姿势

## 基本学习路线

**软件工程师**掌握Kafka的路线：
- 第一步，就是要根据你掌握的编程语言去寻找对应的 **Kafka 客户端**。它们更新和维护的速度很快，非常适合你持续花时间投入。
- 第二步，马上去**官网**上学习一下**代码示例**，如果能够**正确编译和运行**这些样例，你就能轻松地驾驭客户端了。
- 第三步，你可以尝试修改样例代码尝试去理解并使用其他的 API，之后观测你修改的结果。
- 第四步，自己编写一个小型项目来验证下学习成果，然后就是改善和提升客户端的可靠性和性能了。 这一步，你可以熟读一遍 Kafka 官网文档，确保你理解的那些可能影响可靠性和性能的参数。
- 最后，学习Kafka的高级功能： 流处理应用开发（时间窗口聚合，流处理连接）


**运维工程师**学习路线：
- 学习如何搭建和管理Kafka线上环境。
- 对生产环境的监控是重中之重。 Kafka提供了超多JMX监控指标，你可以选择任意你熟悉的框架进行监控。
- 有了监控数据，就需要观测真实业务负载下的Kafka集群表现。 根据指标找出系统瓶颈，提升整个系统的吞吐量。



## 基本使用

### 线上方案制定


### 集群配置参数

---
# 一、Kafka入门

## 消息引擎基础

维基百科介绍：消息引擎系统是一组规范。企业利用这组规范在不同系统之间传递语义准确的消息，实现松耦合的异步式数据传递。


**消息的格式**

既然消息引擎是用于**在不同系统之间传输消息**的，那么如何设计待传输**消息的格式**从来都是一等一的大事。试问一条消息如何做到**信息表达业务语义而无歧义**，同时它还要能最大限度地**提供可重用性以及通用性**?

Kafka选择了**纯二进制的字节序列**。当然消息还是结构化的，只是在使用之前都要将其转换成二进制的字节序列。


**消息模型**

点对点模型 vs 发布/订阅模型
-  点对点模型:也叫消息队列模型。 一对一服务， 比如电话客服。
-  发布/订阅模型: 有个topic的概念， 可以存在多个发布者向相同的主题发送消息，订阅者也可以有多个。 比如报纸订阅。

Kafka支持这两种传输方式。


**为啥要用消息引擎，而不是直接系统之间发送？**

- **削峰填谷**
  - 上下游处理消息的逻辑不一样，而速度有慢有快。

- 发送发和接收方的松耦合，一定程度上简化了应用的开发，减少了系统间不必要的交互。


**聪明人也要下死功夫。**

作者说： 在 2015 年那会儿，我花了将近 1 年的时间阅读 Kafka 源代码，期间多次想要放弃。你要知道**阅读将近 50 万行源码是多么痛的领悟**。我还记得当初为了手写源代码注释，自己写满了一个厚厚的笔记本。之前的所有努力也没有白费，以至于后面写书、写极客时间专栏就变成了一件件水到渠成的事情。

## Kafka基本术语

（术语见 《Kafka入门》- 概念名词解释）

消息模型-点对点： 点对点指的是同一条消息只能被下游的一个消费者消费，其他消费者则不能染指。在 Kafka 中实现这种 P2P 模型的方法就是引入了**消费者组**(Consumer Group)。

所谓的消费者组，指的是多个消费者实例共同组成一个组来消费一组主题。这组主题中的每个分区都只会被组内的一个消费者实例消费，其他消费者实 例不能消费它。


为什么要引入消费者组呢?主要是为了提升消费者端的吞吐量。多个消费者 实例同时消费，加速整个消费端的吞吐量(TPS)。


## Kafka角色定位


## Kafka版本选择

---
# 二、客户端

## 生产者

### 分区机制


### 压缩算法


### 无消息丢失配置



### 高级功能


### TCP连接管理


### 幂等性生产与事务



## 消费者

### 消费者组


### 位移主题


### Rebalance


### 位移提交



### 异常处理


### 多线程开发实例


### TCP连接管理


### group监控

---
# Kafka原理

## 备份机制


## 请求处理

## Rebalance全流程解析


## Controller


## 高水位

---
# 运维与监控


## 主题管理

## 动态配置


## 消费组位移管理


## KafkaAdminClient


## 认证机制


## MirrorMaker


## 监控框架


## 授权管理

## Kafka调优


## 流处理应用搭建实例


---
# 高级Kafka应用

## Kafka Stream


## Kafka DSL开发


## 应用实例